<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Dashboard - HR Restaurant</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }

    .sidebar {
      background: linear-gradient(135deg, #005f73, #0a9396);
      color: white;
    }

    .sidebar .nav-link.active,
    .sidebar .nav-link:hover {
      background-color: rgba(255, 255, 255, 0.2);
      color: #ffffff;
    }

    .dashboard-card {
      background-color: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      text-align: center;
      margin-bottom: 20px;
    }

    .stats-number {
      font-size: 2rem;
      font-weight: bold;
      color: #005f73;
    }

    .stats-label {
      font-size: 1rem;
      color: #6c757d;
    }

    table th {
      background-color: #e3f2fd;
    }

    .badge.bg-success {
      background-color: #2a9d8f !important;
    }

    .badge.bg-warning {
      background-color: #f4a261 !important;
    }

    .badge.bg-danger {
      background-color: #e76f51 !important;
    }

    .badge.bg-info {
      background-color: #219ebc !important;
    }

    .table {
      background-color: white;
      border-radius: 8px;
      overflow: hidden;
    }

    .cart-summary {
      background-color: #ffffff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      margin-top: 20px;
    }

    .cart-summary .total {
      font-size: 1.5rem;
      font-weight: bold;
      color: #005f73;
    }
    
  df-messenger {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 9999;
  }


  </style>
</head>
<body>
  <div class="d-flex">
    <!-- Sidebar -->
    <div class="sidebar d-flex flex-column flex-shrink-0 p-3">
      <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
        <i class="bi bi-house-door me-2"></i>
        <span class="fs-4">HR Restaurant</span>
      </a>
      <hr>
      <ul class="nav nav-pills flex-column mb-auto">
        <li class="nav-item">
          <a href="#" class="nav-link active text-white">
            <i class="bi bi-speedometer2 me-2"></i>
            Dashboard
          </a>
        </li>
        <li>
          <a href="#" class="nav-link text-white">
            <i class="bi bi-cart me-2"></i>
            My Orders
          </a>
        </li>
        <li>
          <a href="#" class="nav-link text-white">
            <i class="bi bi-calendar-check me-2"></i>
            My Reservations
          </a>
        </li>
        <li>
          <a href="#" class="nav-link text-white">
            <i class="bi bi-person me-2"></i>
            Profile
          </a>
        </li>
      </ul>
      <hr>
      <div class="dropdown">
        <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
          <img src="https://github.com/mdo.png" alt="" width="32" height="32" class="rounded-circle me-2">
          <strong>{{ session.username }}</strong>
        </a>
        <ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdownUser1">
          <li><a class="dropdown-item" href="#">Settings</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" href="{{ url_for('logout') }}">Sign out</a></li>
        </ul>
      </div>
    </div>

    <!-- Main Content -->
    <div class="flex-grow-1 p-4">
      <h2 class="mb-4 text-primary">Welcome back, {{ session.username }}!</h2>

      <!-- Cart Summary -->
      <div class="cart-summary">
        <h3 class="mb-4">Your Cart</h3>
        <table class="table">
          <thead>
            <tr>
              <th>Item</th>
              <th>Quantity</th>
              <th>Price</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            {% for item in cart_items %}
            <tr>
              <td>{{ item.name }}</td>
              <td>{{ item.quantity }}</td>
              <td>${{ item.price }}</td>
              <td>${{ item.quantity * item.price }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <div class="total">
          Total: ${{ cart_total }}
        </div>

        <button class="btn btn-success mt-3" data-bs-toggle="modal" data-bs-target="#paymentModal">Proceed to Payment</button>
      </div>

      <!-- Recent Orders -->
      <div class="dashboard-card mt-4">
        <h3 class="mb-4">Recent Orders</h3>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Date</th>
                <th>Items</th>
                <th>Total</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              {% for order in recent_orders %}
              <tr>
                <td>#{{ order.id }}</td>
                <td>{{ order.date }}</td>
                <td>{{ order.items }}</td>
                <td>${{ order.total }}</td>
                <td>
                  <span class="badge bg-{{ order.status_color }}">{{ order.status }}</span>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- Upcoming Reservations -->
      <div class="dashboard-card mt-4">
        <h3 class="mb-4">Upcoming Reservations</h3>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Guests</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              {% for reservation in upcoming_reservations %}
              <tr>
                <td>{{ reservation.date }}</td>
                <td>{{ reservation.time }}</td>
                <td>{{ reservation.guests }}</td>
                <td>
                  <span class="badge bg-{{ reservation.status_color }}">{{ reservation.status }}</span>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
    <!-- Chatbot integration -->
    <script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
<df-messenger
  intent="WELCOME"
  chat-title="RestaurantChatbot"
  agent-id="81d8f6b5-a73a-436a-ab5b-7764f2539c28"
  language-code="en"
></df-messenger>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const chatbot = document.createElement('df-messenger');
      chatbot.setAttribute('intent', 'WELCOME');
      chatbot.setAttribute('chat-title', 'RestaurantChatbot');
      chatbot.setAttribute('agent-id', '81d8f6b5-a73a-436a-ab5b-7764f2539c28');
      chatbot.setAttribute('language-code', 'en');
      document.body.appendChild(chatbot);
    });
  </script>
  
</body>
</html>
